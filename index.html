<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>VIP ROYAL CASINO - CH·ªÆ M·ªû B√ÅT FIX</title>
    <style>
        :root {
            --gold: #ffcc00; --gold-dark: #b8860b; --tai: #ffd84d; --xiu: #4fc3ff; --bg: #050505; --win: #2ecc71;
            --chip-10m: #00a8ff; --chip-50m: #9c88ff; --chip-100m: #e84118; --chip-all: #fbc531;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0; padding: 0; }
        body {
            margin: 0; background-color: var(--bg); color: #fff;
            font-family: 'Segoe UI', Roboto, sans-serif;
            display: flex; justify-content: center; align-items: center; min-height: 100vh;
            background-image: radial-gradient(circle at center, #1a1a1a 0%, #000 100%);
            overflow: hidden;
        }

        /* XOAY M√ÄN H√åNH WARNING */
        #orientation-warning {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 99999; flex-direction: column; justify-content: center; align-items: center;
        }
        @media screen and (max-width: 900px) and (orientation: portrait) { #orientation-warning { display: flex; } }

        .container {
            display: grid; grid-template-columns: 20vw 52vw 22vw; gap: 1vw;
            width: 98vw; height: 95vh; max-width: 1600px;
        }

        .glass-panel {
            background: rgba(20, 20, 25, 0.95); border: 1.5px solid rgba(255, 204, 0, 0.3); border-radius: 30px;
            padding: 15px; display: flex; flex-direction: column; position: relative;
            box-shadow: 0 0 40px rgba(0,0,0,1);
        }

        /* CHAT BOX */
        .chat-box { flex: 1; overflow-y: auto; margin-top: 10px; scroll-behavior: smooth; }
        .chat-msg { margin-bottom: 8px; font-size: 13px; color: #eee; }
        .chat-user { font-weight: bold; margin-right: 5px; }

        /* HEADER INFO */
        .session-info { font-size: 14px; color: var(--gold); font-weight: bold; margin-bottom: 5px; text-align: left; }
        .jp-box {
            background: linear-gradient(180deg, #900, #300); border: 2px solid var(--gold);
            border-radius: 20px; padding: 8px; text-align: center; margin-bottom: 8px;
        }
        .jp-value { font-size: clamp(20px, 4vh, 38px); color: #fff; font-family: 'Courier New', monospace; font-weight: bold; text-shadow: 0 0 15px #f00; }
        
        #timer { font-size: clamp(35px, 6vh, 50px); font-weight: 900; color: #fff; text-shadow: 0 0 20px var(--gold); text-align: center; }

        /* B√ÅT ƒêƒ®A & CH·ªÆ M·ªû B√ÅT */
        .bowl-wrap {
            width: clamp(160px, 32vh, 230px); height: clamp(160px, 32vh, 230px);
            margin: 5px auto; background: #000; border-radius: 50%;
            border: 10px solid #222; position: relative;
            display: flex; justify-content: center; align-items: center; box-shadow: 0 0 35px var(--gold);
        }
        .lid {
            position: absolute; width: 100%; height: 100%; background: radial-gradient(circle at 35% 35%, #555, #000);
            border-radius: 50%; z-index: 10; cursor: pointer; transition: 0.8s cubic-bezier(0.6, -0.2, 0.3, 1.3);
            display: flex; justify-content: center; align-items: center; border: 1px solid #333;
        }
        .lid.open { transform: translate(140%, -100%) rotate(40deg); opacity: 0; pointer-events: none; }
        
        /* CH·ªÆ M·ªû B√ÅT RI√äNG BI·ªÜT */
        #open-text {
            display: none; position: absolute; z-index: 11;
            font-size: 24px; font-weight: 900; color: #fff;
            text-shadow: 0 0 10px gold, 0 0 20px orange;
            pointer-events: none; text-align: center;
            animation: pulseText 1s infinite;
            border: 2px solid var(--gold); padding: 5px 15px; border-radius: 30px; background: rgba(0,0,0,0.6);
        }
        @keyframes pulseText { 0%, 100% { transform: scale(1); opacity: 1; } 50% { transform: scale(1.15); opacity: 0.8; } }

        .shake-anim { animation: wiggle 0.1s infinite; }
        @keyframes wiggle { 0% { transform: translate(1px, 1px); } 50% { transform: translate(-2px, -2px); } }

        .dice { width: 50px; height: 50px; background: #fff; border-radius: 10px; color: #000; font-size: 30px; font-weight: bold; display: flex; justify-content: center; align-items: center; box-shadow: 3px 3px 0 #999; margin: 0 5px; }

        /* B√ÄN C∆Ø·ª¢C */
        .bet-area { display: flex; gap: 15px; margin-top: 5px; }
        .bet-box { flex: 1; background: rgba(255,255,255,0.03); padding: 12px; border-radius: 20px; border: 2px solid #333; cursor: pointer; text-align: center; }
        .bet-box.selected { border-color: var(--gold); background: rgba(255, 204, 0, 0.1); }
        .bet-amt-text { color: #fff !important; font-size: 22px; font-weight: bold; text-shadow: 0 0 10px var(--gold); }

        /* CHIPS */
        .chip-row { display: flex; justify-content: center; gap: 8px; margin-top: 10px; }
        .chip {
            width: 60px; height: 60px; border-radius: 50%; border: 4px dashed rgba(255,255,255,0.3);
            cursor: pointer; font-weight: 900; font-size: 13px; display: flex; justify-content: center; align-items: center;
            transition: 0.2s; box-shadow: 0 5px 0 rgba(0,0,0,0.5);
        }
        .chip:active { transform: translateY(3px); }
        .chip-10m { background: radial-gradient(circle, var(--chip-10m), #004d7c); color: #fff; }
        .chip-50m { background: radial-gradient(circle, var(--chip-50m), #4834d4); color: #fff; }
        .chip-100m { background: radial-gradient(circle, var(--chip-100m), #800); color: #fff; }
        .chip-all { background: radial-gradient(circle, var(--chip-all), #b8860b); color: #000; }

        /* ROADMAP */
        .roadmap-container {
            margin-top: 10px; background: #000; border: 1.5px solid var(--gold);
            border-radius: 12px; padding: 5px; height: 110px; display: flex; flex-wrap: wrap; align-content: flex-start; gap: 2px;
            background-image: linear-gradient(rgba(255,255,255,0.05) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.05) 1px, transparent 1px);
            background-size: 18px 18px;
        }
        .dot { width: 16px; height: 16px; border-radius: 50%; }
        .dot.tai { background: radial-gradient(circle at 30% 30%, #fff, var(--tai), #b8860b); box-shadow: 0 0 8px var(--tai); }
        .dot.xiu { background: radial-gradient(circle at 30% 30%, #fff, var(--xiu), #1e90ff); box-shadow: 0 0 8px var(--xiu); }

        /* BANKING */
        #balance { color: var(--win); font-size: 24px; font-weight: bold; text-shadow: 0 0 10px rgba(46, 204, 113, 0.5); }
        .btn-dep { background: linear-gradient(180deg, #f1c40f, #d35400); color: #fff; border: none; padding: 10px; border-radius: 10px; font-weight: bold; width: 100%; cursor: pointer; margin-top: 5px; }
        .btn-dep.disabled { background: #444; color: #888; cursor: not-allowed; }

        #audio-starter { position: fixed; top: 10px; left: 10px; z-index: 2000; padding: 8px 15px; background: var(--gold); border: none; border-radius: 20px; font-weight: bold; cursor: pointer; font-size: 12px; color: #000; box-shadow: 0 0 10px gold;}
    </style>
</head>
<body>

<div id="orientation-warning">
    <h2 style="color:var(--gold)">VUI L√íNG XOAY NGANG ƒêI·ªÜN THO·∫†I</h2>
</div>

<button id="audio-starter" onclick="game.enableSound()">üîä B·∫¨T NH·∫†C VIP</button>

<audio id="m-bg" loop src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-15.mp3"></audio>
<audio id="s-chip" src="https://assets.mixkit.co/active_storage/sfx/2571/2571-preview.mp3"></audio>
<audio id="s-dice" loop src="https://www.zapsplat.com/wp-content/uploads/2015/sound-effects-one/game_die_roll_on_surface_001.mp3"></audio>
<audio id="s-win" src="https://assets.mixkit.co/active_storage/sfx/1435/1435-preview.mp3"></audio>
<audio id="s-jp" src="https://assets.mixkit.co/active_storage/sfx/2017/2017-preview.mp3"></audio>

<div class="container">
    <div class="side-panel glass-panel">
        <h3>üí¨ TR√í CHUY·ªÜN</h3>
        <div class="chat-box" id="chat-box"></div>
    </div>

    <div class="main-game glass-panel">
        <div class="session-info" id="session-id">PHI√äN: #000001</div>
        <div class="jp-box">
            <div class="jp-value" id="jp-val">100,000,000</div>
            <div style="font-size: 10px; color: gold; letter-spacing: 2px;">üê≤ QU·ª∏ H≈® R·ªíNG THI√äNG üê≤</div>
        </div>

        <div id="timer">--</div>
        <div id="status" style="font-size: 12px; font-weight:bold; color:var(--gold); text-align:center;">ƒêANG ƒê·ªíNG B·ªò...</div>
        
        <div class="bowl-wrap">
            <div id="open-text">M·ªû B√ÅT</div>
            <div class="lid" id="lid" onclick="game.openLid()"></div>
            <div id="d1" class="dice">?</div>
            <div id="d2" class="dice">?</div>
            <div id="d3" class="dice">?</div>
        </div>

        <div class="bet-area">
            <div class="bet-box selected" id="box-tai" onclick="game.selectSide('TAI')">
                <h2 style="color: var(--tai);">T√ÄI</h2>
                <div id="val-tai" class="bet-amt-text">0</div>
            </div>
            <div class="bet-box" id="box-xiu" onclick="game.selectSide('XIU')">
                <h2 style="color: var(--xiu);">X·ªàU</h2>
                <div id="val-xiu" class="bet-amt-text">0</div>
            </div>
        </div>

        <div class="chip-row">
            <div class="chip chip-10m" onclick="game.addMoney(10000000)">10M</div>
            <div class="chip chip-50m" onclick="game.addMoney(50000000)">50M</div>
            <div class="chip chip-100m" onclick="game.addMoney(100000000)">100M</div>
            <div class="chip chip-all" onclick="game.allIn()">ALL</div>
            <div class="chip" style="background:#333; width:45px; height:45px; font-size:10px; border:none;" onclick="game.clearBet()">X√ìA</div>
        </div>
    </div>

    <div class="side-panel glass-panel">
        <div style="margin-bottom: 10px;">
            <h3>üè¶ NG√ÇN H√ÄNG</h3>
            <b id="balance">1,000,000,000</b>
            <input type="number" id="inp-dep" placeholder="N·∫°p t·ªëi ƒëa 10 t·ª∑" style="width: 100%; padding: 8px; background:#000; border:1px solid #444; color:#fff; border-radius:5px; margin-top:5px; text-align: center;">
            <button id="btn-dep" class="btn-dep" onclick="game.deposit()">N·∫†P TI·ªÄN</button>
        </div>
        <div style="flex: 1; display: flex; flex-direction: column;">
            <h3>üìä SOI C·∫¶U (SHARED)</h3>
            <div class="roadmap-container" id="hist-dots"></div>
        </div>
    </div>
</div>

<script>
class InfiniteCasino {
    constructor() {
        this.balance = 1000000000;
        this.jackpot = 500000000;
        this.state = 'IDLE'; 
        this.side = 'TAI';
        this.betT = 0; this.betX = 0;
        this.isMuted = true;
        this.roundDuration = 40; 
        
        this.init();
        this.startChat();
    }

    getSyncedResult(sessionNum) {
        const s = Math.sin(sessionNum) * 10000;
        const rand = s - Math.floor(s);
        const isJp = rand < 0.01;
        let d = [];
        if(isJp) {
            const val = Math.floor(rand * 6) + 1;
            d = [val, val, val];
        } else {
            d = [Math.floor((rand * 13) % 6) + 1, Math.floor((rand * 131) % 6) + 1, Math.floor((rand * 1313) % 6) + 1];
            if(d[0]===d[1] && d[1]===d[2]) d[0] = d[0]===6?1:d[0]+1;
        }
        const sum = d[0]+d[1]+d[2];
        return { dice: d, sum, win: sum >= 11 ? 'TAI' : 'XIU', isJp };
    }

    init() {
        setInterval(() => this.mainLoop(), 1000);
        this.updateUI();
    }

    mainLoop() {
        const now = Math.floor(Date.now() / 1000);
        const cyclePos = now % this.roundDuration; 
        const currentSession = Math.floor(now / this.roundDuration); 
        
        document.getElementById('session-id').innerText = "PHI√äN: #" + currentSession.toString().padStart(6, '0');

        if (cyclePos < 25) {
            if (this.state !== 'BETTING') { this.resetRound(); this.state = 'BETTING'; }
            this.timer = 25 - cyclePos;
            document.getElementById('status').innerText = "ƒêANG ƒê·∫∂T C∆Ø·ª¢C";
            document.getElementById('timer').innerText = this.timer;
        } 
        else if (cyclePos >= 25 && cyclePos < 35) {
            if (this.state === 'BETTING') {
                this.state = 'WAIT_OPEN';
                this.lockAndShake(currentSession);
            }
            // T·ª∞ ƒê·ªòNG M·ªû N·∫æU QU√Å GI·ªú
            if (cyclePos === 34 && !document.getElementById('lid').classList.contains('open')) {
                this.openLid();
            }
            document.getElementById('timer').innerText = "!";
        }
        else {
            this.state = 'RESULT';
            document.getElementById('timer').innerText = "RESET";
        }
        this.syncHistory(currentSession);
    }

    syncHistory(currentSession) {
        let h = [];
        for(let i = 1; i <= 24; i++) h.push(this.getSyncedResult(currentSession - i).win);
        document.getElementById('hist-dots').innerHTML = h.reverse().map(i => `<div class="dot ${i.toLowerCase()}"></div>`).join('');
    }

    lockAndShake(session) {
        document.getElementById('status').innerText = "H·∫æT GI·ªú! M·ªúI M·ªû B√ÅT";
        document.getElementById('lid').classList.add('shake-anim');
        document.getElementById('open-text').style.display = 'block'; // HI·ªÜN CH·ªÆ M·ªû B√ÅT
        this.playSfx('s-dice', true);
        this.currentRes = this.getSyncedResult(session);
    }

    openLid() {
        if(this.state !== 'WAIT_OPEN') return;
        this.stopSfx('s-dice');
        document.getElementById('open-text').style.display = 'none'; // ·∫®N CH·ªÆ KHI M·ªû
        document.getElementById('lid').classList.remove('shake-anim');
        document.getElementById('lid').classList.add('open');
        this.state = 'ANIMATING';
        let c = 0;
        let shuffle = setInterval(() => {
            document.getElementById('d1').innerText = Math.floor(Math.random()*6)+1;
            document.getElementById('d2').innerText = Math.floor(Math.random()*6)+1;
            document.getElementById('d3').innerText = Math.floor(Math.random()*6)+1;
            if(++c > 15) { clearInterval(shuffle); this.calculate(); }
        }, 80);
    }

    calculate() {
        const r = this.currentRes;
        document.getElementById('d1').innerText = r.dice[0];
        document.getElementById('d2').innerText = r.dice[1];
        document.getElementById('d3').innerText = r.dice[2];
        if(r.isJp) { this.playSfx('s-jp'); this.balance += this.jackpot; } 
        else {
            let win = (r.win === 'TAI') ? this.betT * 2 : this.betX * 2;
            if(win > 0) { this.balance += win; this.playSfx('s-win'); }
        }
        this.updateUI();
        document.getElementById('status').innerText = `K·∫æT QU·∫¢: ${r.win} (${r.sum})`;
    }

    resetRound() {
        this.betT = 0; this.betX = 0;
        document.getElementById('open-text').style.display = 'none';
        document.getElementById('lid').classList.remove('open', 'shake-anim');
        document.getElementById('d1').innerText = "?"; document.getElementById('d2').innerText = "?"; document.getElementById('d3').innerText = "?";
        this.updateUI();
    }

    updateUI() {
        document.getElementById('balance').innerText = this.balance.toLocaleString();
        document.getElementById('val-tai').innerText = this.betT.toLocaleString();
        document.getElementById('val-xiu').innerText = this.betX.toLocaleString();
        document.getElementById('box-tai').className = this.side === 'TAI' ? 'bet-box selected' : 'bet-box';
        document.getElementById('box-xiu').className = this.side === 'XIU' ? 'bet-box selected' : 'bet-box';
        const btn = document.getElementById('btn-dep');
        if(this.balance > 0) { btn.classList.add('disabled'); btn.innerText = "C√íN TI·ªÄN..."; }
        else { btn.classList.remove('disabled'); btn.innerText = "N·∫†P TI·ªÄN"; }
    }

    deposit() {
        if(this.balance > 0) return;
        let a = parseInt(document.getElementById('inp-dep').value);
        if(a > 0) { this.balance += Math.min(a, 10000000000); this.playSfx('s-chip'); document.getElementById('inp-dep').value = ""; this.updateUI(); }
    }

    addMoney(m) {
        if(this.state !== 'BETTING' || this.balance < m) return;
        this.playSfx('s-chip');
        if(this.side === 'TAI') this.betT += m; else this.betX += m;
        this.balance -= m; this.updateUI();
    }
    allIn() { this.addMoney(this.balance); }
    clearBet() { if(this.state === 'BETTING') { this.balance += (this.betT + this.betX); this.betT = 0; this.betX = 0; this.updateUI(); } }
    selectSide(s) { if(this.state === 'BETTING') { this.side = s; this.updateUI(); } }
    enableSound() { this.isMuted = false; document.getElementById('m-bg').volume = 0.2; document.getElementById('m-bg').play(); document.getElementById('audio-starter').style.display = 'none'; }
    playSfx(id, loop = false) { if(!this.isMuted) { const el = document.getElementById(id); el.currentTime = 0; el.loop = loop; el.play(); } }
    stopSfx(id) { document.getElementById(id).pause(); document.getElementById(id).currentTime = 0; }

    startChat() {
        const msgs = ["B·ªãp vcl admin", "L·∫°i x·ªâu, v√£i c·∫ßu", "H√∫p 200 c·ªß th∆°m", "C·∫ßu b·ªát ƒë·∫πp vcl", "Ch√°y t√∫i r admin", "T√†i ƒëi anh em", "Admin b·ªãp v√£i l", "N·ªï h≈© c√°i coi", "Vcl c·∫ßu g√¨ ƒë√¢y"];
        const users = ["Ho√†ngKa", "Tr√πm_TX", "B√©Heo", "·∫®nDanh", "ƒê·∫°iGia"];
        setInterval(() => {
            const div = document.createElement('div');
            div.className = 'chat-msg';
            div.innerHTML = `<span class="chat-user" style="color:var(--gold)">${users[Math.floor(Math.random()*users.length)]}${Math.floor(Math.random()*99)}:</span> ${msgs[Math.floor(Math.random()*msgs.length)]}`;
            const box = document.getElementById('chat-box');
            box.appendChild(div);
            if(box.children.length > 40) box.removeChild(box.firstChild);
            box.scrollTop = box.scrollHeight;
        }, 2200);
    }
}
const game = new InfiniteCasino();
</script>
</body>
</html>
