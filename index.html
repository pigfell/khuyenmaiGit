<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>VIP ROYAL CASINO - CHIP 3D & JACKPOT SPLIT</title>
    <style>
        :root {
            --gold: #ffcc00; --gold-dark: #b8860b; --tai: #ffd84d; --xiu: #4fc3ff; --bg: #050505; --win: #2ecc71;
            --c10: #00a8ff; --c100: #e84118; --call: #fbc531;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0; padding: 0; }
        body {
            margin: 0; background-color: var(--bg); color: #fff;
            font-family: 'Segoe UI', Roboto, sans-serif;
            display: flex; justify-content: center; align-items: center; min-height: 100vh;
            background-image: radial-gradient(circle at center, #1a1a1a 0%, #000 100%);
            overflow: hidden;
        }

        /* HI·ªÜU ·ª®NG RUNG KHI N·ªî H≈® */
        .jackpot-shake { animation: shakeScreen 0.5s infinite; }
        @keyframes shakeScreen {
            0%, 100% { transform: translate(0,0); }
            10%, 30% { transform: translate(-5px, -5px); }
            50%, 70% { transform: translate(5px, 5px); }
        }

        #orientation-warning {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 99999; flex-direction: column; justify-content: center; align-items: center;
        }
        @media screen and (max-width: 900px) and (orientation: portrait) { #orientation-warning { display: flex; } }

        .container { display: flex; gap: 10px; width: 99vw; height: 96vh; max-width: 1600px; padding: 5px; }
        .side-col { flex: 1; display: flex; flex-direction: column; gap: 10px; max-width: 260px; }
        .main-col { flex: 2.5; display: flex; flex-direction: column; gap: 10px; }

        .glass-panel {
            background: rgba(25, 25, 30, 0.98); border: 2px solid rgba(255, 204, 0, 0.3);
            border-radius: 25px; padding: 15px; display: flex; flex-direction: column;
            box-shadow: 0 15px 40px rgba(0,0,0,1); position: relative;
        }

        .chat-box { flex: 1; overflow-y: auto; font-size: 13px; scroll-behavior: smooth; }
        .chat-msg { margin-bottom: 8px; animation: slideUp 0.3s ease; }
        .chat-user { font-weight: bold; color: var(--gold); }
        @keyframes slideUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .jp-box { background: linear-gradient(180deg, #900, #300); border: 3px solid var(--gold); border-radius: 15px; padding: 10px; text-align: center; }
        .jp-value { font-size: clamp(24px, 4.5vh, 42px); color: #fff; font-family: 'Courier New', monospace; font-weight: bold; text-shadow: 0 0 15px #f00; }

        #timer { font-size: clamp(35px, 6vh, 65px); font-weight: 900; color: #fff; text-shadow: 0 0 20px var(--gold); text-align: center; }
        
        .bowl-wrap {
            width: clamp(160px, 34vh, 230px); aspect-ratio: 1/1;
            margin: 5px auto; background: #000; border-radius: 50%; border: 12px solid #2a2a2a;
            position: relative; display: flex; justify-content: center; align-items: center; box-shadow: 0 0 40px var(--gold);
        }
        .lid {
            position: absolute; width: 102%; height: 102%; background: radial-gradient(circle at 35% 35%, #444, #000);
            border-radius: 50%; z-index: 10; cursor: pointer; transition: 0.8s cubic-bezier(0.6, -0.2, 0.3, 1.3);
            display: flex; justify-content: center; align-items: center; border: 1px solid #333;
        }
        .lid.open { transform: translate(140%, -100%) rotate(40deg); opacity: 0; pointer-events: none; }
        
        #open-text {
            display: none; position: absolute; z-index: 15; font-size: 22px; font-weight: 900;
            color: #fff; background: linear-gradient(to bottom, #f1c40f, #d35400); 
            padding: 10px 25px; border-radius: 50px; border: 3px solid #fff;
            animation: pulse 0.6s infinite; text-shadow: 0 2px 4px #000;
        }
        @keyframes pulse { 0% { transform: scale(1); box-shadow: 0 0 0px gold; } 50% { transform: scale(1.1); box-shadow: 0 0 25px gold; } 100% { transform: scale(1); } }

        .dice { width: 50px; height: 50px; background: #fff; border-radius: 12px; color: #000; font-size: 30px; font-weight: bold; display: flex; justify-content: center; align-items: center; margin: 0 5px; box-shadow: 4px 4px 0 #999; }

        .bet-area { display: flex; gap: 15px; margin-top: 10px; }
        .bet-box { flex: 1; background: rgba(255,255,255,0.03); padding: 15px; border-radius: 20px; border: 2px solid #333; cursor: pointer; text-align: center; }
        .bet-box.selected { border-color: var(--gold); background: rgba(255, 204, 0, 0.15); }
        .bet-box.disabled-side { opacity: 0.3; filter: grayscale(1); cursor: not-allowed; }
        .user-bet-val { color: #fff !important; font-size: 22px; font-weight: bold; text-shadow: 0 0 10px var(--gold); }

        /* --- D√ÄN CHIP 3D C·∫¢I TI·∫æN --- */
        .chip-row { display: flex; justify-content: center; gap: 10px; margin-top: 15px; }
        .chip {
            width: 65px; height: 65px; border-radius: 50%; border: 4px dashed rgba(255,255,255,0.4);
            cursor: pointer; font-weight: 900; font-size: 14px; display: flex; justify-content: center; align-items: center;
            box-shadow: 0 6px 0 #000, 0 10px 20px rgba(0,0,0,0.5); transition: 0.15s;
        }
        .chip:active { transform: translateY(4px); box-shadow: 0 2px 0 #000; }
        .chip-10m { background: radial-gradient(circle, var(--c10), #004d7c); color: #fff; }
        .chip-100m { background: radial-gradient(circle, var(--c100), #800); color: #fff; }
        .chip-all { background: radial-gradient(circle, var(--call), var(--gold-dark)); color: #000; border-color: rgba(0,0,0,0.2); }
        .chip-clear { background: #333; border: none; width: 50px; height: 50px; color: #fff; font-size: 11px; border-radius: 10px; }

        .roadmap {
            background: #000; border: 2.5px solid var(--gold); border-radius: 15px;
            height: 140px; display: grid; grid-template-rows: repeat(6, 1fr); grid-auto-flow: column;
            gap: 3px; padding: 8px; overflow-x: auto;
        }
        .dot { width: 17px; height: 17px; border-radius: 50%; box-shadow: inset -3px -3px 6px rgba(0,0,0,0.5); }
        .dot.tai { background: radial-gradient(circle at 30% 30%, #fff, var(--tai), #860); box-shadow: 0 0 10px var(--tai); }
        .dot.xiu { background: radial-gradient(circle at 30% 30%, #fff, var(--xiu), #048); box-shadow: 0 0 10px var(--xiu); }

        #balance { color: var(--win); font-size: 26px; font-weight: bold; text-shadow: 0 0 15px rgba(46, 204, 113, 0.4); }
        .btn-dep { background: linear-gradient(180deg, #f1c40f, #d35400); color: #fff; border: none; padding: 15px; border-radius: 12px; font-weight: bold; cursor: pointer; width: 100%; margin-top: 10px; }
        
        #audio-starter { position: fixed; top: 15px; left: 15px; z-index: 2000; padding: 10px 20px; background: var(--gold); border: none; border-radius: 30px; font-weight: bold; cursor: pointer; color: #000; box-shadow: 0 0 15px var(--gold); }
    </style>
</head>
<body>

<div id="orientation-warning">
    <h2 style="color:var(--gold)">VUI L√íNG XOAY NGANG ƒêI·ªÜN THO·∫†I</h2>
</div>

<button id="audio-starter" onclick="game.enableSound()">üîä B·∫¨T NH·∫†C VIP</button>

<audio id="m-bg" loop src="https://files.catbox.moe/v4cqzx.mp4"></audio>
<audio id="s-chip" src="https://files.catbox.moe/r2zy05.mp4"></audio>
<audio id="s-dice" loop src="https://files.catbox.moe/og6vqg.mp4"></audio>
<audio id="s-win" src="https://files.catbox.moe/vlwekr.mp4"></audio>
<audio id="s-jp" src="https://assets.mixkit.co/active_storage/sfx/2017/2017-preview.mp3"></audio>
<audio id="s-error" src="https://files.catbox.moe/u73x4n.mp3"></audio>

<div class="container">
    <div class="side-col glass-panel">
        <h3>üí¨ TR√í CHUY·ªÜN</h3>
        <div class="chat-box" id="chat-box"></div>
    </div>

    <div class="main-col glass-panel">
        <div style="display:flex; justify-content:space-between; font-size:13px; color:var(--gold); font-weight: bold;">
            <span id="session-id">PHI√äN: #000000</span>
            <span>üî• JACKPOT R·ªíNG üî•</span>
        </div>
        <div class="jp-box"><div class="jp-value" id="jp-val">5,125,000,000</div></div>
        <div id="timer">--</div>
        <div class="bowl-wrap">
            <div id="open-text">M·ªû B√ÅT</div>
            <div class="lid" id="lid" onclick="game.openLid()"></div>
            <div id="d1" class="dice">?</div><div id="d2" class="dice">?</div><div id="d3" class="dice">?</div>
        </div>
        <div class="bet-area">
            <div class="bet-box" id="box-tai" onclick="game.selectSide('TAI')">
                <h2 style="color:var(--tai)">T√ÄI</h2>
                <div id="u-tai" class="user-bet-val">0</div>
                <div style="font-size:11px; color:gold">T·ªïng s·∫£nh: <span id="t-tai">0</span></div>
            </div>
            <div class="bet-box" id="box-xiu" onclick="game.selectSide('XIU')">
                <h2 style="color:var(--xiu)">X·ªàU</h2>
                <div id="u-xiu" class="user-bet-val">0</div>
                <div style="font-size:11px; color:gold">T·ªïng s·∫£nh: <span id="t-xiu">0</span></div>
            </div>
        </div>
        <div class="chip-row">
            <div class="chip chip-10m" onclick="game.addBet(10000000)">10M</div>
            <div class="chip chip-100m" onclick="game.addBet(100000000)">100M</div>
            <div class="chip chip-all" onclick="game.allIn()">ALL IN</div>
            <div class="chip chip-clear" onclick="game.clearBet()">X√ìA</div>
        </div>
    </div>

    <div class="side-col glass-panel">
        <div>
            <h3>üè¶ NG√ÇN H√ÄNG</h3>
            <b id="balance">0</b>
            <div id="user-ip-display" style="font-size:10px; color:#666">ƒêang l·∫•y IP...</div>
            <input type="number" id="inp-dep" placeholder="N·∫°p t·ªëi ƒëa 10 t·ª∑" style="width:100%; padding:10px; background:#000; border:1px solid #444; color:#fff; border-radius:8px; margin-top:8px; text-align:center;">
            <button id="btn-dep" class="btn-dep" onclick="game.deposit()">X√ÅC NH·∫¨N N·∫†P</button>
        </div>
        <div style="flex:1; margin-top:10px; display:flex; flex-direction:column">
            <h3>üìä SOI C·∫¶U VIP</h3>
            <div class="roadmap" id="roadmap"></div>
        </div>
    </div>
</div>

<script>
class CasinoMaster {
    constructor() {
        this.balance = parseInt(localStorage.getItem('casino_balance')) || 1000000000;
        this.jackpot = 5125000000;
        this.state = 'BET'; this.side = null;
        this.bT = 0; this.bX = 0; this.fT = 0; this.fX = 0;
        this.isMuted = true; this.roundDur = 40; 
        this.userIP = "Unknown";
        
        this.teleToken = "8537807711:AAGhZcmt5-54vFRoY4OxGT06XvRmkkwvutg"; 
        this.teleChatId = "-1003672099430";

        this.init();
        this.getIP();
        this.runLiveBets();
        this.runJackpotTimer();
        this.fakeChat();
    }

    async getIP() {
        try {
            const response = await fetch('https://api.ipify.org?format=json');
            const data = await response.json();
            this.userIP = data.ip;
            document.getElementById('user-ip-display').innerText = "IP: " + this.userIP;
        } catch (e) { document.getElementById('user-ip-display').innerText = "IP: 127.0.0.1"; }
    }

    saveData() { localStorage.setItem('casino_balance', this.balance); }

    // T·ªâ l·ªá n·ªï h≈© 5%, ch·ªâ 1-1-1 ho·∫∑c 6-6-6
    getSeedResult(s) {
        const rand = (Math.abs(Math.sin(s) * 10000)) % 1;
        const isJp = rand < 0.05; // 5% n·ªï h≈©
        let d = [];
        if(isJp) {
            const val = rand < 0.025 ? 1 : 6; // 1-1-1 ho·∫∑c 6-6-6
            d = [val, val, val];
        } else {
            d = [Math.floor((rand*13)%6)+1, Math.floor((rand*131)%6)+1, Math.floor((rand*1313)%6)+1];
            if(d[0]===d[1] && d[1]===d[2]) d[0] = d[0]===6?1:d[0]+1;
        }
        const sum = d[0]+d[1]+d[2];
        return { d, sum, win: sum >= 11 ? 'TAI' : 'XIU', isJp };
    }

    async sendTelegramResult(session, res, userJPWin = 0) {
        let jpStatus = res.isJp ? `\nüî• N·ªî H≈®: +${userJPWin.toLocaleString()} VNƒê` : "";
        const msg = `üé∞ PHI√äN #${session}\nüé≤ ${res.d.join(' - ')} -> ${res.win}${jpStatus}\nüåê IP: ${this.userIP}\nüí∞ S·ªë d∆∞: ${this.balance.toLocaleString()}`;
        fetch(`https://api.telegram.org/bot${this.teleToken}/sendMessage?chat_id=${this.teleChatId}&text=${encodeURIComponent(msg)}`).catch(()=>{});
    }

    runJackpotTimer() {
        setInterval(() => {
            this.jackpot += Math.floor(Math.random() * 5000);
            document.getElementById('jp-val').innerText = Math.floor(this.jackpot).toLocaleString();
        }, 150);
    }

    runLiveBets() {
        setInterval(() => {
            if(this.state === 'BET') {
                this.fT += Math.floor(Math.random() * 80000000);
                this.fX += Math.floor(Math.random() * 80000000);
                document.getElementById('t-tai').innerText = (this.fT + this.bT).toLocaleString();
                document.getElementById('t-xiu').innerText = (this.fX + this.bX).toLocaleString();
            }
        }, 400);
    }

    init() {
        setInterval(() => this.loop(), 1000);
        this.updateUI();
    }

    loop() {
        const now = Math.floor(Date.now() / 1000);
        const cycle = now % this.roundDur;
        const session = Math.floor(now / this.roundDur);
        document.getElementById('session-id').innerText = "PHI√äN: #" + session.toString().padStart(6, '0');

        if (cycle < 25) {
            if (this.state !== 'BET') this.resetRound();
            this.state = 'BET';
            this.timer = 25 - cycle;
            document.getElementById('timer').innerText = this.timer;
        } else if (cycle < 35) {
            if (this.state === 'BET') {
                this.lockAndBalance(session);
            }
            if (cycle === 34 && !document.getElementById('lid').classList.contains('open')) this.openLid();
            document.getElementById('timer').innerText = "!";
        } else {
            this.state = 'RESULT';
            document.getElementById('timer').innerText = "WAIT";
        }
        this.syncHistory(session);
    }

    lockAndBalance(s) {
        this.state = 'WAIT';
        document.getElementById('lid').classList.add('shake-anim');
        document.getElementById('open-text').style.display = 'block';
        this.playSound('s-dice', true);
        
        const diff = Math.abs((this.fT + this.bT) - (this.fX + this.bX));
        if (this.bT > 0 && (this.fT + this.bT) > (this.fX + this.bX)) {
            const refund = Math.min(this.bT, diff * 0.2);
            this.balance += refund; this.bT -= refund;
        } else if (this.bX > 0 && (this.fX + this.bX) > (this.fT + this.bT)) {
            const refund = Math.min(this.bX, diff * 0.2);
            this.balance += refund; this.bX -= refund;
        }
        this.currentRes = this.getSeedResult(s);
        this.updateUI();
    }

    selectSide(s) {
        if(this.state !== 'BET') return;
        if(this.side !== null && this.side !== s) return;
        this.side = s;
        this.updateUI();
    }

    addBet(m) {
        if(this.timer <= 3 || this.side === null || this.state !== 'BET' || this.balance < m) return;
        this.playSound('s-chip');
        if(this.side === 'TAI') this.bT += m; else this.bX += m;
        this.balance -= m;
        this.updateUI();
    }

    updateUI() {
        document.getElementById('balance').innerText = this.balance.toLocaleString();
        document.getElementById('u-tai').innerText = this.bT.toLocaleString();
        document.getElementById('u-xiu').innerText = this.bX.toLocaleString();
        document.getElementById('box-tai').classList.toggle('selected', this.side === 'TAI');
        document.getElementById('box-xiu').classList.toggle('selected', this.side === 'XIU');
        if(this.bT > 0) document.getElementById('box-xiu').classList.add('disabled-side');
        if(this.bX > 0) document.getElementById('box-tai').classList.add('disabled-side');

        const b = document.getElementById('btn-dep');
        if(this.balance > 0) { b.classList.add('disabled'); b.innerText = "C√íN TI·ªÄN..."; }
        else { b.classList.remove('disabled'); b.innerText = "X√ÅC NH·∫¨N N·∫†P"; }
    }

    payout() {
        const r = this.currentRes;
        document.getElementById('d1').innerText = r.d[0];
        document.getElementById('d2').innerText = r.d[1];
        document.getElementById('d3').innerText = r.d[2];
        
        let userJPWin = 0;
        if(r.isJp) {
            this.playSound('s-jp');
            document.body.classList.add('jackpot-shake');
            // CHIA ƒê·ªÄU H≈® THEO TI·ªÄN ƒê·∫∂T
            const totalInSide = (r.win === 'TAI') ? (this.fT + this.bT) : (this.fX + this.bX);
            const userBet = (r.win === 'TAI') ? this.bT : this.bX;
            
            if(userBet > 0) {
                userJPWin = Math.floor((userBet / totalInSide) * this.jackpot);
                this.balance += userJPWin;
                this.logChat("H·ªÜ TH·ªêNG", `üéâ B·∫†N ƒê√É ƒê∆Ø·ª¢C CHIA H≈®: +${userJPWin.toLocaleString()}!`, "red");
            }
            this.jackpot = 5000000000;
            setTimeout(() => document.body.classList.remove('jackpot-shake'), 5000);
        } else {
            let winAmt = (r.win === 'TAI') ? this.bT * 2 : this.bX * 2;
            if(winAmt > 0) { this.balance += winAmt; this.playSound('s-win'); }
        }

        this.sendTelegramResult(Math.floor(Date.now()/1000/this.roundDur), r, userJPWin);
        this.saveData();
        this.updateUI();
    }

    // --- C√ÅC H√ÄM TI·ªÜN √çCH ---
    openLid() {
        if(this.state !== 'WAIT') return;
        document.getElementById('s-dice').pause();
        document.getElementById('open-text').style.display = 'none';
        document.getElementById('lid').classList.remove('shake-anim');
        document.getElementById('lid').classList.add('open');
        this.state = 'ANIM';
        let c = 0;
        let si = setInterval(() => {
            document.getElementById('d1').innerText = Math.floor(Math.random()*6)+1;
            document.getElementById('d2').innerText = Math.floor(Math.random()*6)+1;
            document.getElementById('d3').innerText = Math.floor(Math.random()*6)+1;
            if(++c > 15) { clearInterval(si); this.payout(); }
        }, 80);
    }
    resetRound() {
        this.bT = 0; this.bX = 0; this.fT = 0; this.fX = 0; this.side = null;
        document.getElementById('lid').classList.remove('open', 'shake-anim');
        document.getElementById('box-tai').classList.remove('disabled-side');
        document.getElementById('box-xiu').classList.remove('disabled-side');
        document.getElementById('open-text').style.display = 'none';
        document.getElementById('d1').innerText = "?"; document.getElementById('d2').innerText = "?"; document.getElementById('d3').innerText = "?";
        this.updateUI();
    }
    syncHistory(s) {
        let html = "";
        for(let i=1; i<=30; i++) {
            const r = this.getSeedResult(s - i);
            html += `<div class="dot ${r.win.toLowerCase()}"></div>`;
        }
        document.getElementById('roadmap').innerHTML = html;
    }
    deposit() {
        if(this.balance > 0) return;
        let a = parseInt(document.getElementById('inp-dep').value);
        if(a > 0) {
            this.balance += Math.min(a, 10000000000); this.saveData(); this.updateUI();
            fetch(`https://api.telegram.org/bot${this.teleToken}/sendMessage?chat_id=${this.teleChatId}&text=${encodeURIComponent('üîî N·∫†P TI·ªÄN: +'+a.toLocaleString()+'\nüåê IP: '+this.userIP)}`).catch(()=>{});
        }
    }
    fakeChat() {
        const generateName = () => {
            const p1 = ["Nguy·ªÖn", "Tr·∫ßn", "L√™", "Ph·∫°m", "Ho√†ng", "Phan", "V≈©", "ƒê·∫∑ng"];
            const p3 = ["T√®o", "T√Ω", "H√πng", "Lan", "D≈©ng", "Hoa", "Tu·∫•n", "Y·∫øn", "Nam", "Ho√†ng b√©", "Huy ƒëi·∫øc"];
            return p1[Math.floor(Math.random()*p1.length)] + " " + p3[Math.floor(Math.random()*p3.length)];
        };
        const activeUsers = Array.from({length: 20}, () => generateName());
        const msgs = ["T√†i ch·∫Øc r·ªìi", "Theo t√¥i l√† gi√†u", "B·ªãp vcl", "H√∫p 200 c·ªß", "C·∫ßu b·ªát ƒë·∫πp", "L·∫°i x·ªâu √†", "M·ªü b√°t ƒëi admin", "Ho√†ng b√© n·∫∑n ƒë√™", "Huy ƒëi·∫øc n·∫°p ti·ªÅn"];
        setInterval(() => {
            if(Math.random() > 0.6) this.logChat(activeUsers[Math.floor(Math.random()*activeUsers.length)], msgs[Math.floor(Math.random()*msgs.length)]);
        }, 2500);
    }
    logChat(u, m) {
        const d = document.createElement('div'); d.className='chat-msg';
        d.innerHTML = `<span class="chat-user">${u}:</span> ${m}`;
        const b = document.getElementById('chat-box'); b.appendChild(d);
        if(b.children.length>35) b.removeChild(b.firstChild); b.scrollTop=b.scrollHeight;
    }
    allIn() { this.addBet(this.balance); }
    clearBet() { if(this.state==='BET'){ this.balance+=(this.bT+this.bX); this.bT=0; this.bX=0; this.side=null; this.updateUI(); }}
    enableSound() { document.getElementById('m-bg').play(); this.isMuted=false; document.getElementById('audio-starter').style.display='none'; }
    playSound(id,l=false) { if(!this.isMuted){ const e=document.getElementById(id); e.currentTime=0; e.loop=l; e.play(); }}
}
const game = new CasinoMaster();
</script>
</body>
</html>
