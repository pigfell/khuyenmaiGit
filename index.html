<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ROYAL CASINO - BOSS EDITION 2026</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --gold: #ffcc00; --gold-dark: #b8860b; --tai: #ffd84d; --xiu: #4fc3ff; --bg: #050505; --win: #ff0000;
            --chip-bg: linear-gradient(180deg, #332a22 0%, #110d0a 100%);
            --chip-border: #8e6d45; --glass: rgba(18, 18, 22, 0.98);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0; padding: 0; }
        body {
            margin: 0; background-color: var(--bg); color: #fff;
            font-family: 'Segoe UI', Roboto, sans-serif;
            display: flex; justify-content: center; align-items: center; min-height: 100vh;
            background-image: radial-gradient(circle at center, #1a1a1a 0%, #000 100%);
            overflow: hidden;
        }

        #win-marquee {
            position: fixed; top: 100px; width: 100%; overflow: hidden; white-space: nowrap;
            background: rgba(0,0,0,0.8); border-top: 1px solid var(--gold); border-bottom: 1px solid var(--gold);
            padding: 8px 0; z-index: 500; display: none;
        }
        .marquee-text { display: inline-block; padding-left: 100%; font-weight: 900; font-size: 22px; color: var(--gold); animation: marquee 15s linear infinite; }
        @keyframes marquee { 0% { transform: translate(0, 0); } 100% { transform: translate(-100%, 0); } }

        .container { display: flex; gap: 10px; width: 100vw; height: 100vh; padding: 8px; max-width: 1550px; }
        .side-col-chat { flex: 0 0 350px; display: flex; flex-direction: column; gap: 10px; }
        .side-col-bank { flex: 0 0 260px; display: flex; flex-direction: column; gap: 10px; }
        .main-col { flex: 1; display: flex; flex-direction: column; gap: 10px; }

        .glass-panel { background: var(--glass); border: 1.5px solid rgba(255, 204, 0, 0.2); border-radius: 20px; padding: 15px; display: flex; flex-direction: column; box-shadow: 0 10px 40px rgba(0,0,0,1); position: relative; }

        .chat-box { flex: 1; overflow-y: auto; font-size: 14px; display: flex; flex-direction: column; gap: 10px; padding: 5px; }
        .chat-msg { padding: 10px; border-radius: 12px; background: rgba(255,255,255,0.05); border-left: 3px solid var(--gold); }
        .chat-user { font-weight: 900; color: var(--gold); margin-bottom: 2px; display: block; }
        
        .chat-input-area { display: flex; gap: 5px; margin-top: 10px; background: #111; padding: 8px; border-radius: 10px; }
        #chat-input { flex: 1; background: transparent; border: none; color: #fff; outline: none; }

        .jp-box { background: linear-gradient(180deg, #900, #300); border: 2px solid var(--gold); border-radius: 12px; padding: 10px; text-align: center; }
        .jp-value { font-size: 40px; color: #fff; font-family: 'Courier New', monospace; font-weight: bold; text-shadow: 0 0 15px #f00; }

        #timer { font-size: 70px; font-weight: 900; color: #fff; text-shadow: 0 0 30px var(--gold); text-align: center; margin: 10px 0; }
        
        .bowl-wrap { width: 200px; height: 200px; margin: 0 auto; background: #111; border-radius: 50%; border: 8px solid #222; position: relative; display: flex; justify-content: center; align-items: center; box-shadow: 0 0 30px rgba(0,0,0,0.5); }
        .lid { position: absolute; width: 100%; height: 100%; background: radial-gradient(circle at 35% 35%, #333, #000); border-radius: 50%; z-index: 20; cursor: pointer; transition: 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275); border: 1px solid #444; }
        .lid.open { transform: translate(120%, -80%) rotate(45deg); opacity: 0; pointer-events: none; }

        .dice { width: 45px; height: 45px; background: #fff; border-radius: 8px; color: #000; font-size: 30px; font-weight: bold; display: flex; justify-content: center; align-items: center; margin: 0 4px; box-shadow: 3px 3px 0 #999; z-index: 5; }

        .bet-area { display: flex; gap: 15px; margin-top: 10px; }
        .bet-box { flex: 1; background: rgba(0,0,0,0.5); padding: 15px; border-radius: 15px; border: 2px solid #333; cursor: pointer; text-align: center; transition: 0.2s; }
        .bet-box.selected { border-color: var(--gold); background: rgba(255, 204, 0, 0.1); }
        .user-bet-val { color: #fff; font-size: 26px; font-weight: 900; text-shadow: 0 0 10px var(--gold); margin: 5px 0; }

        .chip-row { display: flex; justify-content: center; gap: 6px; margin-top: 15px; }
        .chip { width: 75px; height: 50px; background: var(--chip-bg); border: 2px solid var(--chip-border); border-radius: 10px; display: flex; justify-content: center; align-items: center; font-weight: 900; color: #fbc531; cursor: pointer; }
        .chip:active { transform: scale(0.95); }

        .roadmap { background: #000; border: 1px solid #333; border-radius: 10px; height: 100px; display: grid; grid-template-rows: repeat(6, 1fr); grid-auto-flow: column; gap: 2px; padding: 5px; overflow-x: auto; }
        .dot { width: 14px; height: 14px; border-radius: 50%; }
        .dot.tai { background: radial-gradient(circle at 30% 30%, #fff, var(--tai), #860); }
        .dot.xiu { background: radial-gradient(circle at 30% 30%, #fff, var(--xiu), #048); }

        #balance { color: var(--gold); font-size: 28px; font-weight: bold; }
        .btn-dep { background: linear-gradient(180deg, #f1c40f, #d35400); color: #fff; border: none; padding: 15px; border-radius: 10px; font-weight: bold; cursor: pointer; width: 100%; margin-top: 10px; font-size: 18px; }
        
        .win-blink { animation: blinkRed 0.4s infinite; border-color: #ff0000 !important; }
        @keyframes blinkRed { 50% { opacity: 0.5; transform: scale(1.02); } }
        
        #chart-modal { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 3000; width: 90%; max-width: 900px; background: #0a0a0c; border: 2px solid var(--gold); border-radius: 20px; padding: 20px; }
        .chart-btn { background: #222; border: 1px solid var(--gold); padding: 10px 20px; border-radius: 10px; color: #fff; cursor: pointer; margin-top: 10px; width: 100%; }
    </style>
</head>
<body>

<div id="win-marquee"><div class="marquee-text" id="marquee-content"></div></div>

<div id="chart-modal">
    <div style="display:flex; justify-content:space-between; color:var(--gold); margin-bottom:15px;">
        <h3>BI·ªÇU ƒê·ªí MD5</h3><b onclick="game.toggleChart()" style="cursor:pointer; font-size:30px;">&times;</b>
    </div>
    <canvas id="md5Chart" height="200"></canvas>
</div>

<audio id="s-chip" src="https://files.catbox.moe/r2zy05.mp4"></audio>
<audio id="s-dice" src="https://files.catbox.moe/og6vqg.mp4"></audio>
<audio id="s-win" src="https://files.catbox.moe/vlwekr.mp4"></audio>

<div class="container">
    <div class="side-col-chat glass-panel">
        <h3 style="color:var(--gold); text-align:center;">üí¨ KHU V·ª∞C CHAT</h3>
        <div class="chat-box" id="chat-box"></div>
        <div class="chat-input-area">
            <input type="text" id="chat-input" placeholder="Nh·∫≠p tin nh·∫Øn..." onkeypress="if(event.key==='Enter') game.sendRealChat()">
            <button onclick="game.sendRealChat()" style="background:var(--gold); border:none; padding:5px 10px; border-radius:5px; font-weight:bold;">G·ª¨I</button>
        </div>
    </div>

    <div class="main-col glass-panel">
        <div style="display:flex; justify-content:space-between; font-size:12px; color:#666;">
            <span id="session-id">PHI√äN: #--</span><span>HUÃÉ TH∆Ø∆†ÃâNG</span>
        </div>
        <div class="jp-box"><div class="jp-value" id="jp-val">5,000,000,000</div></div>
        
        <div id="timer">--</div>
        
        <div class="bowl-wrap">
            <div class="lid" id="lid" onclick="game.manualOpen()"></div>
            <div id="d1" class="dice">?</div>
            <div id="d2" class="dice">?</div>
            <div id="d3" class="dice">?</div>
        </div>
        
        <div class="bet-area">
            <div class="bet-box" id="box-tai" onclick="game.selectSide('TAI')">
                <h2 style="color:var(--tai);">T√ÄI</h2>
                <div id="u-tai" class="user-bet-val">0</div>
                <div style="font-size:11px; color:#555">T·ªïng: <span id="t-tai" style="color:#aaa">0</span></div>
            </div>
            <div class="bet-box" id="box-xiu" onclick="game.selectSide('XIU')">
                <h2 style="color:var(--xiu);">X·ªàU</h2>
                <div id="u-xiu" class="user-bet-val">0</div>
                <div style="font-size:11px; color:#555">T·ªïng: <span id="t-xiu" style="color:#aaa">0</span></div>
            </div>
        </div>

        <div class="chip-row">
            <div class="chip" onclick="game.addBet(10000000)">10M</div>
            <div class="chip" onclick="game.addBet(50000000)">50M</div>
            <div class="chip" onclick="game.addBet(100000000)">100M</div>
            <div class="chip" onclick="game.allIn()" style="background:var(--win); color:#fff;">ALL IN</div>
            <button onclick="game.clearBet()" style="background:#222; color:#777; border:none; padding:0 10px; border-radius:8px;">X√ìA</button>
        </div>
        <button class="chart-btn" onclick="game.toggleChart()">üìä SOI C·∫¶U CHI TI·∫æT</button>
    </div>

    <div class="side-col-bank glass-panel">
        <h3 style="color:var(--gold);">üè¶ V√ç TI·ªÄN</h3>
        <div id="balance">400,000,000</div>
        <input type="number" id="inp-dep" placeholder="S·ªë ti·ªÅn n·∫°p..." style="width:100%; padding:12px; margin-top:10px; background:#000; border:1px solid #333; color:#fff; border-radius:8px;">
        <button class="btn-dep" onclick="game.deposit()">N·∫†P TI·ªÄN</button>
        
        <div style="margin-top:20px;">
            <h4 style="color:var(--gold); margin-bottom:5px;">L·ªäCH S·ª¨ C·∫¶U</h4>
            <div class="roadmap" id="roadmap"></div>
        </div>
    </div>
</div>

<script>
class CasinoGame {
    constructor() {
        this.balance = parseInt(localStorage.getItem('casino_balance')) || 500000000;
        this.state = 'BET'; // BET, WAIT, RESULT
        this.timer = 0;
        this.side = null;
        this.bT = 0; this.bX = 0; // Ti·ªÅn ng∆∞·ªùi ch∆°i
        this.fT = 0; this.fX = 0; // Ti·ªÅn ·∫£o
        this.history = [];
        this.roundDur = 45;
        this.currentRes = null;
        this.init();
    }

    init() {
        setInterval(() => this.tick(), 1000);
        setInterval(() => this.fakeLiveBet(), 500);
        this.updateUI();
        this.logChat("H·ªá th·ªëng", "Ch√†o m·ª´ng Boss quay tr·ªü l·∫°i s·∫£nh VIP!", "cyan");
    }

    tick() {
        const now = Math.floor(Date.now() / 1000);
        const cycle = now % this.roundDur;
        const session = 4423000 + Math.floor(now / this.roundDur);
        document.getElementById('session-id').innerText = "PHI√äN: #" + session;

        if (cycle < 30) {
            if (this.state !== 'BET') this.startNewRound();
            this.timer = 30 - cycle;
            document.getElementById('timer').innerText = this.timer;
            document.getElementById('timer').style.color = this.timer <= 5 ? "red" : "white";
        } else if (cycle < 40) {
            if (this.state === 'BET') this.lockBet(session);
            document.getElementById('timer').innerText = "ƒêANG N·∫∂N";
        } else {
            if (this.state !== 'RESULT') this.showResult();
            document.getElementById('timer').innerText = "CH·ªú PHI√äN";
        }
    }

    startNewRound() {
        this.state = 'BET';
        this.side = null; this.bT = 0; this.bX = 0; this.fT = 0; this.fX = 0;
        document.getElementById('lid').classList.remove('open');
        document.querySelectorAll('.bet-box').forEach(b => b.classList.remove('win-blink', 'selected'));
        document.querySelectorAll('.dice').forEach(d => d.innerText = "?");
        this.updateUI();
    }

    lockBet(s) {
        this.state = 'WAIT';
        this.playSound('s-dice');
        // T·∫°o k·∫øt qu·∫£ MD5 ·∫£o
        const d = [Math.floor(Math.random()*6)+1, Math.floor(Math.random()*6)+1, Math.floor(Math.random()*6)+1];
        const sum = d[0]+d[1]+d[2];
        this.currentRes = { d, sum, win: sum >= 11 ? 'TAI' : 'XIU', s };
    }

    manualOpen() {
        if (this.state === 'WAIT') {
            document.getElementById('lid').classList.add('open');
            this.showDiceResult();
        }
    }

    showDiceResult() {
        const r = this.currentRes;
        document.getElementById('d1').innerText = r.d[0];
        document.getElementById('d2').innerText = r.d[1];
        document.getElementById('d3').innerText = r.d[2];
        
        this.state = 'RESULT';
        this.history.push(r);
        this.updateRoadmap();

        let winAmt = 0;
        if (this.side === r.win) {
            winAmt = (this.side === 'TAI' ? this.bT : this.bX) * 1.95;
            this.balance += winAmt;
            this.playSound('s-win');
            document.getElementById(r.win === 'TAI' ? 'box-tai' : 'box-xiu').classList.add('win-blink');
            if(winAmt > 0) this.showMarquee(`CH√öC M·ª™NG B·∫†N ƒê√É TH·∫ÆNG +${Math.floor(winAmt).toLocaleString()} VNƒê`);
        }
        localStorage.setItem('casino_balance', this.balance);
        this.updateUI();
    }

    showResult() {
        if(!document.getElementById('lid').classList.contains('open')) {
            this.manualOpen();
        }
    }

    selectSide(s) {
        if (this.state === 'BET') {
            this.side = s;
            document.querySelectorAll('.bet-box').forEach(b => b.classList.remove('selected'));
            document.getElementById(s === 'TAI' ? 'box-tai' : 'box-xiu').classList.add('selected');
        }
    }

    addBet(m) {
        if (this.state === 'BET' && this.side && this.balance >= m) {
            this.balance -= m;
            if (this.side === 'TAI') this.bT += m; else this.bX += m;
            this.playSound('s-chip');
            this.updateUI();
        } else if (!this.side) {
            alert("Vui l√≤ng ch·ªçn T√ÄI ho·∫∑c X·ªàU tr∆∞·ªõc!");
        }
    }

    allIn() { this.addBet(this.balance); }
    clearBet() { if(this.state==='BET'){ this.balance += (this.bT + this.bX); this.bT=0; this.bX=0; this.updateUI(); } }

    deposit() {
        let val = parseInt(document.getElementById('inp-dep').value);
        if(val > 0) { this.balance += val; this.updateUI(); alert("N·∫°p th√†nh c√¥ng!"); }
    }

    updateUI() {
        document.getElementById('balance').innerText = Math.floor(this.balance).toLocaleString();
        document.getElementById('u-tai').innerText = this.bT.toLocaleString();
        document.getElementById('u-xiu').innerText = this.bX.toLocaleString();
        document.getElementById('t-tai').innerText = (this.fT + this.bT).toLocaleString();
        document.getElementById('t-xiu').innerText = (this.fX + this.bX).toLocaleString();
    }

    updateRoadmap() {
        let html = "";
        this.history.slice(-30).forEach(h => {
            html += `<div class="dot ${h.win.toLowerCase()}"></div>`;
        });
        document.getElementById('roadmap').innerHTML = html;
    }

    fakeLiveBet() {
        if (this.state === 'BET') {
            this.fT += Math.floor(Math.random() * 20000000);
            this.fX += Math.floor(Math.random() * 20000000);
            this.updateUI();
        }
    }

    sendRealChat() {
        let inp = document.getElementById('chat-input');
        if(inp.value.trim()){
            this.logChat("B·∫†N", inp.value, "#00ff00");
            inp.value = "";
        }
    }

    logChat(u, m, c) {
        let box = document.getElementById('chat-box');
        let d = document.createElement('div'); d.className='chat-msg';
        d.innerHTML = `<span class="chat-user" style="color:${c||'var(--gold)'}">${u}:</span> ${m}`;
        box.appendChild(d); box.scrollTop = box.scrollHeight;
    }

    showMarquee(txt) {
        let m = document.getElementById('win-marquee');
        document.getElementById('marquee-content').innerText = txt;
        m.style.display = 'block';
        setTimeout(() => m.style.display = 'none', 10000);
    }

    playSound(id) {
        let s = document.getElementById(id);
        if(s) { s.currentTime = 0; s.play().catch(()=>{}); }
    }

    toggleChart() {
        let m = document.getElementById('chart-modal');
        m.style.display = m.style.display === 'block' ? 'none' : 'block';
    }
}

const game = new CasinoGame();
</script>
</body>
</html>
